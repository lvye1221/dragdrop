<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title></title>
		
		<style>
			div {
				width: 200px;
				height: 200px;
				border: 1px solid red;
				
				position: absolute;
			}
		</style>
	</head>
	<body>
		
		

    <script src="js/jquery.js"></script>
    <script src="js/jquery.drag.js"></script>
    <script src="js/jquery.drop.js"></script>
    
	<script>


$(document).on("mouseup", function() {
	console.log(1);	
});

$(document).on("mouseup", function() {
	console.log(2);	
});
		

var i = 1;


// 定义1个构造函数
//  $parent 代表要放入的父元素
function DragBox($parent, html) {
	this.parent = $parent
	
	// 创建1个div
	this.ele = document.createElement("div");
	
	// 设置div中的内容
	if (html != undefined) {
		this.ele.innerHTML = html;
	} else {
		this.ele.innerHTML = i++;
	}
	
	var self = this;
	
	$(this.ele).drop(function (e) {
		// 在这个盒子中释放的时候，会自动调用这个函数
		console.log(e);
		
		// e.srcElement 事件发生的原始元素
		console.log("srcElement" + e.srcElement.innerHTML);
		console.log("self:" + self);
		console.log("self.ele.innerHTML:" + self.ele.innerHTML);
		
		if (e.srcElement == self.ele) {
			console.log("is same");
			return ;
		}
		


		var w = $(self.ele).width();
		
		// 先备份
		var html1 = self.ele.innerHTML
		var html2 = e.srcElement.innerHTML

		// 清空原本
		$(self.ele).html("");

		// 测试输出
		console.log("new1: ", html1)
		console.log("new2: ", html2)

		var o1 = new DragBox($(self.ele), html1);
		var o2 = new DragBox($(self.ele), html2);
		
		$(o1.ele).width(w/2);
		$(o2.ele).css({
			width: w/2,
			left: w/2
		})
		
		
		// 原本的父元素不具备放下的功能
		$(self.ele).drop(null);
		
		$(e.srcElement).remove();
	});

	$(this.ele).drag();
	
	$parent.append(this.ele);
	
	return this;
}

new DragBox($("body"))
new DragBox($("body"))
new DragBox($("body"))

	</script>


	</body>
</html>
